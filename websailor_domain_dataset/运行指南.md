# WebSailor Domain Dataset 运行指南

## 🎯 项目概述

WebSailor Domain Dataset 是一个专门用于构建领域知识图谱和生成问答数据集的工具。它可以从领域文本中自动提取实体、关系，构建知识图谱，并生成相应的问答对数据。

## 🚀 快速开始

### 1. 环境要求
- **Python版本**: 3.8 或更高版本
- **操作系统**: Windows, macOS, Linux 都支持  
- **内存**: 建议至少 4GB RAM
- **存储**: 至少 1GB 可用空间

### 2. 依赖安装

项目依赖已经安装完成，包括：
- NetworkX (图计算)
- jieba (中文分词)
- spaCy (自然语言处理)
- PyTorch (深度学习)
- transformers (预训练模型)
- 其他支持库

### 3. 目录结构

```
websailor_domain_dataset/
├── main.py                 # 主程序入口
├── demo.py                 # 快速演示脚本
├── config.json             # 配置文件
├── requirements.txt        # 依赖包列表
├── README.md               # 项目说明
├── core/                   # 核心功能模块
│   ├── knowledge_graph_builder.py  # 知识图谱构建
│   ├── subgraph_sampler.py         # 子图采样
│   └── qa_generator.py             # 问答生成
├── utils/                  # 工具函数
│   ├── text_utils.py       # 文本处理工具
│   ├── graph_utils.py      # 图处理工具
│   └── file_utils.py       # 文件处理工具
├── templates/              # 模板文件
├── input_texts/            # 输入文本目录
└── output_dataset/         # 输出数据集目录
```

## 📖 使用方法

### 方法1: 快速演示（推荐新用户）

```bash
cd websailor_domain_dataset
python3 demo.py
```

这将运行一个简化的演示，展示：
- 中文分词功能
- 词性标注
- 关键词提取
- 结果保存

### 方法2: 完整功能运行

#### 步骤1: 准备输入数据
将您的领域文本文件放入 `input_texts/` 目录：

```bash
# 创建输入目录（如果不存在）
mkdir -p input_texts

# 将您的文本文件复制到此目录，例如：
cp /path/to/your/domain_text.txt input_texts/
```

**支持的文件格式**：
- `.txt` 文件（UTF-8 编码）
- 建议文件大小在1MB以内
- 文件名建议使用英文

#### 步骤2: 运行主程序

```bash
# 使用默认配置运行
python3 main.py --input-dir input_texts --output-dir output_dataset

# 查看所有可用参数
python3 main.py --help
```

**可用参数**：
- `--config`: 指定配置文件路径
- `--input-dir`: 输入文本目录
- `--output-dir`: 输出数据集目录  
- `--log-level`: 日志级别 (DEBUG, INFO, WARNING, ERROR)

### 方法3: 自定义配置运行

编辑 `config.json` 文件来调整参数：

```json
{
  "subgraph_sampling": {
    "strategies": [
      {
        "name": "topology_based",
        "count": 200,
        "params": {
          "min_nodes": 3,
          "max_nodes": 10
        }
      }
    ]
  },
  "entity_extraction": {
    "use_ner": true,
    "use_dependency_parsing": true,
    "min_entity_length": 2
  }
}
```

然后运行：

```bash
python3 main.py --config config.json --input-dir input_texts --output-dir output_dataset
```

## 📊 输出结果

程序运行完成后，会在输出目录生成以下文件：

```
output_dataset/
├── knowledge_graph.json    # 知识图谱数据
├── subgraphs/             # 子图数据集
│   ├── subgraph_001.json  # 单个子图文件
│   └── ...
├── qa_pairs/              # 问答对数据
│   ├── qa_dataset.json    # 问答数据集
│   └── qa_statistics.json # 统计信息
└── visualizations/        # 可视化结果
    ├── knowledge_graph.html # 知识图谱可视化
    └── subgraph_samples.html # 子图样例可视化
```

## ⚙️ 配置说明

### 主要配置项

1. **子图采样配置** (`subgraph_sampling`)
   - `strategies`: 采样策略列表
   - `count`: 每种策略的采样数量
   - `min_nodes/max_nodes`: 子图节点数范围

2. **实体提取配置** (`entity_extraction`)
   - `use_ner`: 是否使用命名实体识别
   - `use_dependency_parsing`: 是否使用依存句法分析
   - `min_entity_length`: 最小实体长度

3. **问答生成配置** (`qa_generation`)
   - `templates`: 问答模板
   - `max_questions_per_subgraph`: 每个子图最大问题数

## 🔧 故障排除

### 常见问题

1. **依赖包问题**
   ```bash
   pip3 install --break-system-packages -r requirements.txt
   ```

2. **内存不足**
   - 减少配置文件中的采样数量
   - 处理较小的文本文件

3. **编码问题**
   - 确保输入文本为UTF-8编码
   - 检查文件是否包含特殊字符

4. **空知识图谱问题**
   - 检查输入文本质量
   - 调整实体提取参数
   - 增加领域词典

### 日志调试

使用详细日志模式运行：

```bash
python3 main.py --log-level DEBUG --input-dir input_texts --output-dir output_dataset
```

## 📝 示例用法

### 示例1: 处理AI领域文本

```bash
# 1. 准备输入文件
echo "人工智能是计算机科学的重要分支..." > input_texts/ai_domain.txt

# 2. 运行程序
python3 main.py --input-dir input_texts --output-dir ai_dataset

# 3. 查看结果
ls ai_dataset/
```

### 示例2: 批量处理多个文件

```bash
# 1. 准备多个文件
cp domain_text_1.txt input_texts/
cp domain_text_2.txt input_texts/
cp domain_text_3.txt input_texts/

# 2. 运行处理
python3 main.py --input-dir input_texts --output-dir batch_dataset
```

## 🎨 可视化功能

程序会自动生成可视化结果：

1. **知识图谱可视化** - 显示实体和关系的网络图
2. **子图样例可视化** - 展示采样的子图结构
3. **统计图表** - 数据集的统计信息

在浏览器中打开生成的HTML文件即可查看。

## 📦 代码下载

项目代码已打包为：`websailor_domain_dataset_20250728_023039.tar.gz`

**下载位置**: `/workspace/websailor_domain_dataset_20250728_023039.tar.gz`

**解压方法**:
```bash
tar -xzf websailor_domain_dataset_20250728_023039.tar.gz
cd websailor_domain_dataset
```

## 🤝 技术支持

如遇到问题，请：

1. 检查日志输出获取错误信息
2. 确认输入文件格式正确
3. 验证依赖包是否完整安装
4. 查看配置文件参数设置

## 📚 更多信息

- 查看 `README.md` 了解项目详细信息
- 查看 `WEBSAILOR_COMPARISON.md` 了解与原始WebSailor的对比
- 运行 `python3 demo.py` 体验核心功能