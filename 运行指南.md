# WebSailor Domain Dataset 运行指南

## 🚀 快速开始

### 1. 系统要求
- **Python版本**: 3.8 或更高版本
- **操作系统**: Windows, macOS, Linux 都支持
- **内存**: 建议至少 4GB RAM
- **存储**: 至少 1GB 可用空间

### 2. 环境准备

#### 方法一：使用虚拟环境（推荐）
```bash
# 创建虚拟环境
python -m venv websailor_env

# 激活虚拟环境
# Linux/macOS:
source websailor_env/bin/activate
# Windows:
websailor_env\Scripts\activate

# 进入项目目录
cd websailor_domain_dataset

# 安装依赖
pip install -r requirements.txt
```

#### 方法二：直接安装
```bash
# 进入项目目录
cd websailor_domain_dataset

# 直接安装依赖
pip install -r requirements.txt
```

### 3. 准备输入数据

在 `input_texts/` 目录下放置您的领域文本文件：

```bash
# 创建输入目录（如果不存在）
mkdir -p input_texts

# 将您的文本文件复制到此目录
# 例如：
# cp /path/to/your/domain_text.txt input_texts/
```

**支持的文件格式**：
- `.txt` 文件（UTF-8 编码）
- 文件名建议使用英文，如：`tcl_display_tech.txt`

### 4. 配置参数（可选）

编辑 `config.json` 文件来调整生成参数：

```json
{
  "subgraph_sampling": {
    "total_subgraphs": 1000,  // 生成子图数量
    "max_nodes_per_subgraph": 15,  // 每个子图最大节点数
    "sampling_strategies": {
      "star": 0.3,      // 星型结构权重
      "chain": 0.3,     // 链式结构权重
      "tree": 0.2,      // 树型结构权重
      "cycle": 0.2      // 环型结构权重
    }
  },
  "question_generation": {
    "questions_per_subgraph": 3,  // 每个子图生成问题数
    "question_types": {
      "factual": 0.4,        // 事实型问题
      "reasoning": 0.3,      // 推理型问题
      "comparison": 0.2,     // 比较型问题
      "multi_hop": 0.1       // 多跳问题
    }
  }
}
```

## 🎯 运行方式

### 基本运行命令

```bash
# 使用默认配置运行
python main.py

# 指定配置文件
python main.py --config config.json

# 指定输入和输出目录
python main.py --input-dir input_texts --output-dir my_dataset

# 设置日志级别
python main.py --log-level DEBUG
```

### 完整命令示例

```bash
python main.py \
  --config config.json \
  --input-dir input_texts \
  --output-dir output_dataset \
  --log-level INFO
```

## 📁 输出结果

运行完成后，会在输出目录生成以下文件：

```
output_dataset/
├── knowledge_graph.json          # 构建的知识图谱
├── subgraphs.json                # 采样的子图
├── questions_answers.json        # 生成的问答对
├── obfuscated_data.json          # 模糊化处理后的数据
├── reasoning_trajectories.json   # 推理轨迹
├── final_dataset.json            # 最终数据集
├── statistics.json               # 统计信息
└── logs/                         # 运行日志
    └── websailor_YYYYMMDD_HHMMSS.log
```

## 🖥️ 不同环境下的运行方式

### 本地 Windows 环境
```cmd
# 打开命令提示符或PowerShell
cd websailor_domain_dataset
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
python main.py
```

### 本地 macOS/Linux 环境
```bash
# 打开终端
cd websailor_domain_dataset
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python main.py
```

### 服务器环境
```bash
# SSH连接到服务器后
cd /path/to/websailor_domain_dataset
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 后台运行（推荐）
nohup python main.py > run.log 2>&1 &

# 查看运行状态
tail -f run.log
```

### Docker 环境
```bash
# 创建 Dockerfile（如需要）
# 或直接在容器中运行
docker run -it -v $(pwd):/workspace python:3.9
cd /workspace/websailor_domain_dataset
pip install -r requirements.txt
python main.py
```

### Jupyter Notebook 环境
```python
# 在 Jupyter 单元格中运行
import subprocess
import os

os.chdir('websailor_domain_dataset')
result = subprocess.run(['python', 'main.py'], capture_output=True, text=True)
print(result.stdout)
print(result.stderr)
```

## 🔧 常见问题解决

### 1. 依赖安装失败
```bash
# 升级 pip
pip install --upgrade pip

# 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

### 2. 内存不足
```bash
# 减少配置文件中的生成数量
# 编辑 config.json，降低 total_subgraphs 的值
```

### 3. 权限问题
```bash
# Linux/macOS 下给予执行权限
chmod +x main.py
```

### 4. 编码问题
确保输入文本文件使用 UTF-8 编码保存。

## 📊 监控运行状态

### 查看实时日志
```bash
# 查看最新日志
tail -f logs/websailor_*.log

# 查看错误信息
grep "ERROR" logs/websailor_*.log
```

### 检查进程状态
```bash
# Linux/macOS
ps aux | grep python

# Windows
tasklist | findstr python
```

## 🎉 运行成功标志

当看到以下输出时，表示运行成功：

```
[INFO] 知识图谱构建完成，共 X 个节点，Y 个关系
[INFO] 子图采样完成，共生成 Z 个子图
[INFO] 问题生成完成，共生成 W 个问答对
[INFO] 数据集构建完成！输出目录：output_dataset
```

现在您可以根据自己的环境选择合适的运行方式！